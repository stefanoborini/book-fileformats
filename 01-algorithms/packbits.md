PackBits

Packbits is a variation of Run Length Encoding aiming at reducing the
cost of two symbol repetitions. The idea is to classify two kind of data:
encoded with a Run Length Encoding scheme, and non-encoded data to be
interpreted verbatim. To differentiate between the two kinds, a single signed
byte $n$ is used as both a flag and a counter:

  if n is a positive between 0 and 127: use the following 1 + n symbols as they are (verbatim)
  if n is a negative number between -127 and -1: repeat the next symbol 1 - n times. (Run Length Encoding)
  if n is -128, ignore the value. This is implementation-dependent, but generally this value is never generated by the encoder


The algorithm operates by accumulating buffers of symbols, which get normally
written as verbatim. When a run of more than three bytes is found during the
scan, the encoding is performed until a non matching byte interrupts the encoding.
 
As an example, consider the following case:

aaabcdaaaabcdeffffffffff -> -2a     : 1 - (-2) = 3  repetitions of "a"
                             2bcd   : 1 +   2  = 3  verbatim data "bcd"
                            -3a     : 1 - (-3) = 4  repetitions of "a"
                             3bcde  : 1 + 3    = 4  verbatim data "bcde"
                            -9f     : 1 - (-9) = 10 repetitions of "f"

leading to a reduction from 24 bytes to 15 bytes.

